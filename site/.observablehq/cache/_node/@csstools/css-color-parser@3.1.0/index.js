import{TokenType as N,NumberType as b,isTokenHash as Re,isTokenIdent as P,isTokenNumeric as Q,isTokenComma as ee,isTokenDelim as oe,isTokenNumber as S,isTokenDimension as $,isTokenPercentage as Y}from"../css-tokenizer@3.0.4/index.js";import{namedColors as Pe,XYZ_D50_to_P3 as ue,XYZ_D50_to_sRGB as le,XYZ_D50_to_HSL as Ne,sRGB_to_XYZ_D50 as pe,XYZ_D50_to_OKLCH as te,XYZ_D50_to_XYZ_D65 as Be,XYZ_D50_to_XYZ_D50 as be,XYZ_D50_to_OKLab as Xe,XYZ_D50_to_LCH as Ze,XYZ_D50_to_Lab as Me,XYZ_D50_to_HWB as Ge,XYZ_D50_to_a98_RGB as Ye,XYZ_D50_to_ProPhoto as Ve,XYZ_D50_to_rec_2020 as Ke,XYZ_D50_to_lin_P3 as Oe,XYZ_D50_to_lin_sRGB as ze,inGamut as me,clip as ve,gam_P3 as Ae,mapGamutRayTrace as ge,XYZ_D65_to_XYZ_D50 as Ie,OKLCH_to_XYZ_D50 as We,LCH_to_XYZ_D50 as Te,OKLab_to_XYZ_D50 as Ee,Lab_to_XYZ_D50 as Ue,HWB_to_XYZ_D50 as je,HSL_to_XYZ_D50 as $e,ProPhoto_RGB_to_XYZ_D50 as qe,a98_RGB_to_XYZ_D50 as Je,rec_2020_to_XYZ_D50 as Qe,lin_P3_to_XYZ_D50 as ea,P3_to_XYZ_D50 as aa,lin_sRGB_to_XYZ_D50 as na,gam_sRGB as ra,contrast_ratio_wcag_2_1 as _e,XYZ_to_lin_P3 as la,OKLCH_to_OKLab as de,OKLab_to_XYZ as ye,OKLab_to_OKLCH as xe,lin_P3_to_XYZ as ta,XYZ_to_OKLab as He,XYZ_to_lin_sRGB as sa,lin_sRGB_to_XYZ as oa}from"../color-helpers@5.1.0/index.js";import{TokenNode as w,WhitespaceNode as B,FunctionNode as W,isFunctionNode as E,isTokenNode as g,isWhitespaceNode as V,isCommentNode as K,isWhiteSpaceOrCommentNode as we,replaceComponentValues as ua}from"../css-parser-algorithms@3.0.5/index.js";import{mathFunctionNames as ae,calcFromComponentValues as ne}from"../css-calc@2.1.4/index.js";var l,f;function X(e){return[Number.isNaN(e[0])?0:e[0],Number.isNaN(e[1])?0:e[1],Number.isNaN(e[2])?0:e[2]]}function T(e){switch(e.colorNotation){case l.HEX:case l.RGB:case l.sRGB:return{...e,colorNotation:l.XYZ_D50,channels:pe(X(e.channels))};case l.Linear_sRGB:return{...e,colorNotation:l.XYZ_D50,channels:na(X(e.channels))};case l.Display_P3:return{...e,colorNotation:l.XYZ_D50,channels:aa(X(e.channels))};case l.Linear_Display_P3:return{...e,colorNotation:l.XYZ_D50,channels:ea(X(e.channels))};case l.Rec2020:return{...e,colorNotation:l.XYZ_D50,channels:Qe(X(e.channels))};case l.A98_RGB:return{...e,colorNotation:l.XYZ_D50,channels:Je(X(e.channels))};case l.ProPhoto_RGB:return{...e,colorNotation:l.XYZ_D50,channels:qe(X(e.channels))};case l.HSL:return{...e,colorNotation:l.XYZ_D50,channels:$e(X(e.channels))};case l.HWB:return{...e,colorNotation:l.XYZ_D50,channels:je(X(e.channels))};case l.Lab:return{...e,colorNotation:l.XYZ_D50,channels:Ue(X(e.channels))};case l.OKLab:return{...e,colorNotation:l.XYZ_D50,channels:Ee(X(e.channels))};case l.LCH:return{...e,colorNotation:l.XYZ_D50,channels:Te(X(e.channels))};case l.OKLCH:return{...e,colorNotation:l.XYZ_D50,channels:We(X(e.channels))};case l.XYZ_D50:return{...e,colorNotation:l.XYZ_D50,channels:be(X(e.channels))};case l.XYZ_D65:return{...e,colorNotation:l.XYZ_D50,channels:Ie(X(e.channels))};default:throw new Error("Unsupported color notation")}}(function(e){e.A98_RGB="a98-rgb",e.Display_P3="display-p3",e.Linear_Display_P3="display-p3-linear",e.HEX="hex",e.HSL="hsl",e.HWB="hwb",e.LCH="lch",e.Lab="lab",e.Linear_sRGB="srgb-linear",e.OKLCH="oklch",e.OKLab="oklab",e.ProPhoto_RGB="prophoto-rgb",e.RGB="rgb",e.sRGB="srgb",e.Rec2020="rec2020",e.XYZ_D50="xyz-d50",e.XYZ_D65="xyz-d65"})(l||(l={})),function(e){e.ColorKeyword="color-keyword",e.HasAlpha="has-alpha",e.HasDimensionValues="has-dimension-values",e.HasNoneKeywords="has-none-keywords",e.HasNumberValues="has-number-values",e.HasPercentageAlpha="has-percentage-alpha",e.HasPercentageValues="has-percentage-values",e.HasVariableAlpha="has-variable-alpha",e.Hex="hex",e.LegacyHSL="legacy-hsl",e.LegacyRGB="legacy-rgb",e.NamedColor="named-color",e.RelativeColorSyntax="relative-color-syntax",e.ColorMix="color-mix",e.ColorMixVariadic="color-mix-variadic",e.ContrastColor="contrast-color",e.RelativeAlphaSyntax="relative-alpha-syntax",e.Experimental="experimental"}(f||(f={}));const Le=new Set([l.A98_RGB,l.Display_P3,l.Linear_Display_P3,l.HEX,l.Linear_sRGB,l.ProPhoto_RGB,l.RGB,l.sRGB,l.Rec2020,l.XYZ_D50,l.XYZ_D65]);function z(e,n){const a={...e};if(e.colorNotation!==n){const r=T(a);switch(n){case l.HEX:case l.RGB:a.colorNotation=l.RGB,a.channels=le(r.channels);break;case l.sRGB:a.colorNotation=l.sRGB,a.channels=le(r.channels);break;case l.Linear_sRGB:a.colorNotation=l.Linear_sRGB,a.channels=ze(r.channels);break;case l.Display_P3:a.colorNotation=l.Display_P3,a.channels=ue(r.channels);break;case l.Linear_Display_P3:a.colorNotation=l.Linear_Display_P3,a.channels=Oe(r.channels);break;case l.Rec2020:a.colorNotation=l.Rec2020,a.channels=Ke(r.channels);break;case l.ProPhoto_RGB:a.colorNotation=l.ProPhoto_RGB,a.channels=Ve(r.channels);break;case l.A98_RGB:a.colorNotation=l.A98_RGB,a.channels=Ye(r.channels);break;case l.HSL:a.colorNotation=l.HSL,a.channels=Ne(r.channels);break;case l.HWB:a.colorNotation=l.HWB,a.channels=Ge(r.channels);break;case l.Lab:a.colorNotation=l.Lab,a.channels=Me(r.channels);break;case l.LCH:a.colorNotation=l.LCH,a.channels=Ze(r.channels);break;case l.OKLCH:a.colorNotation=l.OKLCH,a.channels=te(r.channels);break;case l.OKLab:a.colorNotation=l.OKLab,a.channels=Xe(r.channels);break;case l.XYZ_D50:a.colorNotation=l.XYZ_D50,a.channels=be(r.channels);break;case l.XYZ_D65:a.colorNotation=l.XYZ_D65,a.channels=Be(r.channels);break;default:throw new Error("Unsupported color notation")}}else a.channels=X(e.channels);if(n===e.colorNotation)a.channels=Z(e.channels,[0,1,2],a.channels,[0,1,2]);else if(Le.has(n)&&Le.has(e.colorNotation))a.channels=Z(e.channels,[0,1,2],a.channels,[0,1,2]);else switch(n){case l.HSL:switch(e.colorNotation){case l.HWB:a.channels=Z(e.channels,[0],a.channels,[0]);break;case l.Lab:case l.OKLab:a.channels=Z(e.channels,[2],a.channels,[0]);break;case l.LCH:case l.OKLCH:a.channels=Z(e.channels,[0,1,2],a.channels,[2,1,0])}break;case l.HWB:switch(e.colorNotation){case l.HSL:a.channels=Z(e.channels,[0],a.channels,[0]);break;case l.LCH:case l.OKLCH:a.channels=Z(e.channels,[0],a.channels,[2])}break;case l.Lab:case l.OKLab:switch(e.colorNotation){case l.HSL:a.channels=Z(e.channels,[0],a.channels,[2]);break;case l.Lab:case l.OKLab:a.channels=Z(e.channels,[0,1,2],a.channels,[0,1,2]);break;case l.LCH:case l.OKLCH:a.channels=Z(e.channels,[0],a.channels,[0])}break;case l.LCH:case l.OKLCH:switch(e.colorNotation){case l.HSL:a.channels=Z(e.channels,[0,1,2],a.channels,[2,1,0]);break;case l.HWB:a.channels=Z(e.channels,[0],a.channels,[2]);break;case l.Lab:case l.OKLab:a.channels=Z(e.channels,[0],a.channels,[0]);break;case l.LCH:case l.OKLCH:a.channels=Z(e.channels,[0,1,2],a.channels,[0,1,2])}}return a.channels=ca(a.channels,n),a}function ca(e,n){const a=[...e];switch(n){case l.HSL:!Number.isNaN(a[1])&&R(a[1],4)<=0&&(a[0]=Number.NaN);break;case l.HWB:Math.max(0,R(a[1],4))+Math.max(0,R(a[2],4))>=100&&(a[0]=Number.NaN);break;case l.LCH:!Number.isNaN(a[1])&&R(a[1],4)<=0&&(a[2]=Number.NaN);break;case l.OKLCH:!Number.isNaN(a[1])&&R(a[1],6)<=0&&(a[2]=Number.NaN)}return a}function q(e,n){const a=[...e];switch(n){case l.HSL:(R(a[2])<=0||R(a[2])>=100)&&(a[0]=Number.NaN,a[1]=Number.NaN),R(a[1])<=0&&(a[0]=Number.NaN);break;case l.HWB:Math.max(0,R(a[1]))+Math.max(0,R(a[2]))>=100&&(a[0]=Number.NaN);break;case l.Lab:(R(a[0])<=0||R(a[0])>=100)&&(a[1]=Number.NaN,a[2]=Number.NaN);break;case l.LCH:R(a[1])<=0&&(a[2]=Number.NaN),(R(a[0])<=0||R(a[0])>=100)&&(a[1]=Number.NaN,a[2]=Number.NaN);break;case l.OKLab:(R(a[0])<=0||R(a[0])>=1)&&(a[1]=Number.NaN,a[2]=Number.NaN);break;case l.OKLCH:R(a[1])<=0&&(a[2]=Number.NaN),(R(a[0])<=0||R(a[0])>=1)&&(a[1]=Number.NaN,a[2]=Number.NaN)}return a}function Z(e,n,a,r){const h=[...a];for(const c of n)Number.isNaN(e[n[c]])&&(h[r[c]]=Number.NaN);return h}function ce(e){const n=new Map;switch(e.colorNotation){case l.RGB:case l.HEX:n.set("r",L(255*e.channels[0])),n.set("g",L(255*e.channels[1])),n.set("b",L(255*e.channels[2])),typeof e.alpha=="number"&&n.set("alpha",L(e.alpha));break;case l.HSL:n.set("h",L(e.channels[0])),n.set("s",L(e.channels[1])),n.set("l",L(e.channels[2])),typeof e.alpha=="number"&&n.set("alpha",L(e.alpha));break;case l.HWB:n.set("h",L(e.channels[0])),n.set("w",L(e.channels[1])),n.set("b",L(e.channels[2])),typeof e.alpha=="number"&&n.set("alpha",L(e.alpha));break;case l.Lab:case l.OKLab:n.set("l",L(e.channels[0])),n.set("a",L(e.channels[1])),n.set("b",L(e.channels[2])),typeof e.alpha=="number"&&n.set("alpha",L(e.alpha));break;case l.LCH:case l.OKLCH:n.set("l",L(e.channels[0])),n.set("c",L(e.channels[1])),n.set("h",L(e.channels[2])),typeof e.alpha=="number"&&n.set("alpha",L(e.alpha));break;case l.sRGB:case l.A98_RGB:case l.Display_P3:case l.Linear_Display_P3:case l.Rec2020:case l.Linear_sRGB:case l.ProPhoto_RGB:n.set("r",L(e.channels[0])),n.set("g",L(e.channels[1])),n.set("b",L(e.channels[2])),typeof e.alpha=="number"&&n.set("alpha",L(e.alpha));break;case l.XYZ_D50:case l.XYZ_D65:n.set("x",L(e.channels[0])),n.set("y",L(e.channels[1])),n.set("z",L(e.channels[2])),typeof e.alpha=="number"&&n.set("alpha",L(e.alpha))}return n}function ie(e){const n=new Map(e);for(const[a,r]of e)Number.isNaN(r[4].value)&&n.set(a,L(0));return n}function L(e){return Number.isNaN(e)?[N.Number,"none",-1,-1,{value:Number.NaN,type:b.Number}]:[N.Number,e.toString(),-1,-1,{value:e,type:b.Number}]}function R(e,n=7){if(Number.isNaN(e))return 0;const a=Math.pow(10,n);return Math.round(e*a)/a}function ia(e){const n={...e,channels:[...e.channels]};return n.channels=q(n.channels,n.colorNotation),!z(n,l.RGB).channels.find(a=>a<-1e-5||a>1.00001)}function ha(e){const n={...e,channels:[...e.channels]};return n.channels=q(n.channels,n.colorNotation),!z(n,l.Display_P3).channels.find(a=>a<-1e-5||a>1.00001)}function p(e,n,a,r){return Math.min(Math.max(e/n,a),r)}const fa=/[A-Z]/g;function C(e){return e.replace(fa,n=>String.fromCharCode(n.charCodeAt(0)+32))}function J(e,n,a){if(P(e)&&C(e[4].value)==="none")return a.syntaxFlags.add(f.HasNoneKeywords),[N.Number,"none",e[2],e[3],{value:Number.NaN,type:b.Number}];if(Y(e)){n!==3&&a.syntaxFlags.add(f.HasPercentageValues);let r=p(e[4].value,100,-2147483647,2147483647);return n===3&&(r=p(e[4].value,100,0,1)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}if(S(e)){n!==3&&a.syntaxFlags.add(f.HasNumberValues);let r=p(e[4].value,1,-2147483647,2147483647);return n===3&&(r=p(e[4].value,1,0,1)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}return!1}const Na=new Set(["srgb","srgb-linear","display-p3","display-p3-linear","a98-rgb","prophoto-rgb","rec2020","xyz","xyz-d50","xyz-d65"]);function pa(e,n){const a=[],r=[],h=[],c=[];let t,o,i=!1,s=!1;const u={colorNotation:l.sRGB,channels:[0,0,0],alpha:1,syntaxFlags:new Set([])};let m=a;for(let _=0;_<e.value.length;_++){let v=e.value[_];if(V(v)||K(v))for(;V(e.value[_+1])||K(e.value[_+1]);)_++;else if(m===a&&a.length&&(m=r),m===r&&r.length&&(m=h),g(v)&&oe(v.value)&&v.value[4].value==="/"){if(m===c)return!1;m=c}else{if(E(v)){if(m===c&&C(v.getName())==="var"){u.syntaxFlags.add(f.HasVariableAlpha),m.push(v);continue}if(!ae.has(C(v.getName())))return!1;const[[H]]=ne([[v]],{censorIntoStandardRepresentableValues:!0,globals:o,precision:-1,toCanonicalUnits:!0,rawPercentages:!0});if(!H||!g(H)||!Q(H.value))return!1;Number.isNaN(H.value[4].value)&&(H.value[4].value=0),v=H}if(m===a&&a.length===0&&g(v)&&P(v.value)&&Na.has(C(v.value[4].value))){if(i)return!1;i=C(v.value[4].value),u.colorNotation=ba(i),s&&(s.colorNotation!==u.colorNotation&&(s=z(s,u.colorNotation)),t=ce(s),o=ie(t))}else if(m===a&&a.length===0&&g(v)&&P(v.value)&&C(v.value[4].value)==="from"){if(s||i)return!1;for(;V(e.value[_+1])||K(e.value[_+1]);)_++;if(_++,v=e.value[_],s=n(v),s===!1)return!1;s.syntaxFlags.has(f.Experimental)&&u.syntaxFlags.add(f.Experimental),u.syntaxFlags.add(f.RelativeColorSyntax)}else{if(!g(v))return!1;if(P(v.value)&&t&&t.has(C(v.value[4].value))){m.push(new w(t.get(C(v.value[4].value))));continue}m.push(v)}}}if(!i||m.length!==1||a.length!==1||r.length!==1||h.length!==1||!g(a[0])||!g(r[0])||!g(h[0])||t&&!t.has("alpha"))return!1;const y=J(a[0].value,0,u);if(!y||!S(y))return!1;const d=J(r[0].value,1,u);if(!d||!S(d))return!1;const k=J(h[0].value,2,u);if(!k||!S(k))return!1;const x=[y,d,k];if(c.length===1)if(u.syntaxFlags.add(f.HasAlpha),g(c[0])){const _=J(c[0].value,3,u);if(!_||!S(_))return!1;x.push(_)}else u.alpha=c[0];else if(t&&t.has("alpha")){const _=J(t.get("alpha"),3,u);if(!_||!S(_))return!1;x.push(_)}return u.channels=[x[0][4].value,x[1][4].value,x[2][4].value],x.length===4&&(u.alpha=x[3][4].value),u}function ba(e){switch(e){case"srgb":return l.sRGB;case"srgb-linear":return l.Linear_sRGB;case"display-p3":return l.Display_P3;case"display-p3-linear":return l.Linear_Display_P3;case"a98-rgb":return l.A98_RGB;case"prophoto-rgb":return l.ProPhoto_RGB;case"rec2020":return l.Rec2020;case"xyz":case"xyz-d65":return l.XYZ_D65;case"xyz-d50":return l.XYZ_D50;default:throw new Error("Unknown color space name: "+e)}}const ma=new Set(["srgb","srgb-linear","display-p3","display-p3-linear","a98-rgb","prophoto-rgb","rec2020","lab","oklab","xyz","xyz-d50","xyz-d65"]),he=new Set(["hsl","hwb","lch","oklch"]),va=new Set(["shorter","longer","increasing","decreasing"]);function ga(e,n){let a=null,r=null,h=null,c=!1;for(let t=0;t<e.value.length;t++){const o=e.value[t];if(!we(o)){if(!(a||g(o)&&P(o.value)&&C(o.value[4].value)==="in"))return Ce("oklab",se(e.value,n));if(g(o)&&P(o.value)){if(!a&&C(o.value[4].value)==="in"){a=o;continue}if(a&&!r){r=C(o.value[4].value);continue}if(a&&r&&!h&&he.has(r)){h=C(o.value[4].value);continue}if(a&&r&&h&&!c&&C(o.value[4].value)==="hue"){c=!0;continue}return!1}return!(!g(o)||!ee(o.value))&&!!r&&(h||c?!!(r&&h&&c&&he.has(r)&&va.has(h))&&De(r,h,se(e.value.slice(t+1),n)):ma.has(r)?Ce(r,se(e.value.slice(t+1),n)):!!he.has(r)&&De(r,"shorter",se(e.value.slice(t+1),n)))}}return!1}function se(e,n){const a=[];let r=1,h=!1,c=!1;for(let s=0;s<e.length;s++){let u=e[s];if(!we(u)){if(!g(u)||!ee(u.value)){if(!h){const m=n(u);if(m){h=m;continue}}if(!c){if(E(u)&&ae.has(C(u.getName()))){if([[u]]=ne([[u]],{censorIntoStandardRepresentableValues:!0,precision:-1,toCanonicalUnits:!0,rawPercentages:!0}),!u||!g(u)||!Q(u.value))return!1;Number.isNaN(u.value[4].value)&&(u.value[4].value=0)}if(g(u)&&Y(u.value)&&u.value[4].value>=0){c=u.value[4].value;continue}}return!1}if(!h)return!1;a.push({color:h,percentage:c}),h=!1,c=!1}}if(!h)return!1;a.push({color:h,percentage:c});let t=0,o=0;for(let s=0;s<a.length;s++){const u=a[s].percentage;if(u!==!1){if(u<0||u>100)return!1;t+=u}else o++}const i=Math.max(0,100-t);t=0;for(let s=0;s<a.length;s++)a[s].percentage===!1&&(a[s].percentage=i/o),t+=a[s].percentage;if(t===0)return{colors:[{color:{channels:[0,0,0],colorNotation:l.sRGB,alpha:0,syntaxFlags:new Set},percentage:0}],alphaMultiplier:0};if(t>100)for(let s=0;s<a.length;s++){let u=a[s].percentage;u=u/t*100,a[s].percentage=u}if(t<100){r=t/100;for(let s=0;s<a.length;s++){let u=a[s].percentage;u=u/t*100,a[s].percentage=u}}return{colors:a,alphaMultiplier:r}}function Ce(e,n){if(!n||!n.colors.length)return!1;const a=n.colors.slice();a.reverse();let r=l.RGB;switch(e){case"srgb":r=l.RGB;break;case"srgb-linear":r=l.Linear_sRGB;break;case"display-p3":r=l.Display_P3;break;case"display-p3-linear":r=l.Linear_Display_P3;break;case"a98-rgb":r=l.A98_RGB;break;case"prophoto-rgb":r=l.ProPhoto_RGB;break;case"rec2020":r=l.Rec2020;break;case"lab":r=l.Lab;break;case"oklab":r=l.OKLab;break;case"xyz-d50":r=l.XYZ_D50;break;case"xyz":case"xyz-d65":r=l.XYZ_D65;break;default:return!1}if(a.length===1){const c=z(a[0].color,r);return c.colorNotation=r,c.syntaxFlags.add(f.ColorMixVariadic),typeof c.alpha!="number"?!1:(c.alpha=c.alpha*n.alphaMultiplier,c)}for(;a.length>=2;){const c=a.pop(),t=a.pop();if(!c||!t)return!1;const o=_a(r,c.color,c.percentage,t.color,t.percentage);if(!o)return!1;a.push({color:o,percentage:c.percentage+t.percentage})}const h=a[0]?.color;return!!h&&(n.colors.some(c=>c.color.syntaxFlags.has(f.Experimental))&&h.syntaxFlags.add(f.Experimental),typeof h.alpha=="number"&&(h.alpha=h.alpha*n.alphaMultiplier,n.colors.length!==2&&h.syntaxFlags.add(f.ColorMixVariadic),h))}function _a(e,n,a,r,h){const c=a/(a+h);let t=n.alpha;if(typeof t!="number")return!1;let o=r.alpha;if(typeof o!="number")return!1;t=Number.isNaN(t)?o:t,o=Number.isNaN(o)?t:o;const i=z(n,e).channels,s=z(r,e).channels;i[0]=M(i[0],s[0]),s[0]=M(s[0],i[0]),i[1]=M(i[1],s[1]),s[1]=M(s[1],i[1]),i[2]=M(i[2],s[2]),s[2]=M(s[2],i[2]),i[0]=A(i[0],t),i[1]=A(i[1],t),i[2]=A(i[2],t),s[0]=A(s[0],o),s[1]=A(s[1],o),s[2]=A(s[2],o);const u=O(t,o,c);return{colorNotation:e,channels:[U(O(i[0],s[0],c),u),U(O(i[1],s[1],c),u),U(O(i[2],s[2],c),u)],alpha:u,syntaxFlags:new Set([f.ColorMix])}}function De(e,n,a){if(!a||!a.colors.length)return!1;const r=a.colors.slice();r.reverse();let h=l.HSL;switch(e){case"hsl":h=l.HSL;break;case"hwb":h=l.HWB;break;case"lch":h=l.LCH;break;case"oklch":h=l.OKLCH;break;default:return!1}if(r.length===1){const t=z(r[0].color,h);return t.colorNotation=h,t.syntaxFlags.add(f.ColorMixVariadic),typeof t.alpha!="number"?!1:(t.alpha=t.alpha*a.alphaMultiplier,t)}for(;r.length>=2;){const t=r.pop(),o=r.pop();if(!t||!o)return!1;const i=da(h,n,t.color,t.percentage,o.color,o.percentage);if(!i)return!1;r.push({color:i,percentage:t.percentage+o.percentage})}const c=r[0]?.color;return!!c&&(a.colors.some(t=>t.color.syntaxFlags.has(f.Experimental))&&c.syntaxFlags.add(f.Experimental),typeof c.alpha=="number"&&(c.alpha=c.alpha*a.alphaMultiplier,a.colors.length!==2&&c.syntaxFlags.add(f.ColorMixVariadic),c))}function da(e,n,a,r,h,c){const t=r/(r+c);let o=0,i=0,s=0,u=0,m=0,y=0,d=a.alpha;if(typeof d!="number")return!1;let k=h.alpha;if(typeof k!="number")return!1;d=Number.isNaN(d)?k:d,k=Number.isNaN(k)?d:k;const x=z(a,e).channels,_=z(h,e).channels;switch(e){case l.HSL:case l.HWB:o=x[0],i=_[0],s=x[1],u=_[1],m=x[2],y=_[2];break;case l.LCH:case l.OKLCH:s=x[0],u=_[0],m=x[1],y=_[1],o=x[2],i=_[2]}o=M(o,i),Number.isNaN(o)&&(o=0),i=M(i,o),Number.isNaN(i)&&(i=0),s=M(s,u),u=M(u,s),m=M(m,y),y=M(y,m);const v=i-o;switch(n){case"shorter":v>180?o+=360:v<-180&&(i+=360);break;case"longer":-180<v&&v<180&&(v>0?o+=360:i+=360);break;case"increasing":v<0&&(i+=360);break;case"decreasing":v>0&&(o+=360);break;default:throw new Error("Unknown hue interpolation method")}s=A(s,d),m=A(m,d),u=A(u,k),y=A(y,k);let H=[0,0,0];const D=O(d,k,t);switch(e){case l.HSL:case l.HWB:H=[O(o,i,t),U(O(s,u,t),D),U(O(m,y,t),D)];break;case l.LCH:case l.OKLCH:H=[U(O(s,u,t),D),U(O(m,y,t),D),O(o,i,t)]}return{colorNotation:e,channels:H,alpha:D,syntaxFlags:new Set([f.ColorMix])}}function M(e,n){return Number.isNaN(e)?n:e}function O(e,n,a){return e*a+n*(1-a)}function A(e,n){return Number.isNaN(n)?e:Number.isNaN(e)?Number.NaN:e*n}function U(e,n){return n===0||Number.isNaN(n)?e:Number.isNaN(e)?Number.NaN:e/n}function ya(e){const n=C(e[4].value);if(n.match(/[^a-f0-9]/))return!1;const a={colorNotation:l.HEX,channels:[0,0,0],alpha:1,syntaxFlags:new Set([f.Hex])},r=n.length;if(r===3){const h=n[0],c=n[1],t=n[2];return a.channels=[parseInt(h+h,16)/255,parseInt(c+c,16)/255,parseInt(t+t,16)/255],a}if(r===6){const h=n[0]+n[1],c=n[2]+n[3],t=n[4]+n[5];return a.channels=[parseInt(h,16)/255,parseInt(c,16)/255,parseInt(t,16)/255],a}if(r===4){const h=n[0],c=n[1],t=n[2],o=n[3];return a.channels=[parseInt(h+h,16)/255,parseInt(c+c,16)/255,parseInt(t+t,16)/255],a.alpha=parseInt(o+o,16)/255,a.syntaxFlags.add(f.HasAlpha),a}if(r===8){const h=n[0]+n[1],c=n[2]+n[3],t=n[4]+n[5],o=n[6]+n[7];return a.channels=[parseInt(h,16)/255,parseInt(c,16)/255,parseInt(t,16)/255],a.alpha=parseInt(o,16)/255,a.syntaxFlags.add(f.HasAlpha),a}return!1}function re(e){if(S(e))return e[4].value=e[4].value%360,e[1]=e[4].value.toString(),e;if($(e)){let n=e[4].value;switch(C(e[4].unit)){case"deg":break;case"rad":n=180*e[4].value/Math.PI;break;case"grad":n=.9*e[4].value;break;case"turn":n=360*e[4].value;break;default:return!1}return n%=360,[N.Number,n.toString(),e[2],e[3],{value:n,type:b.Number}]}return!1}function xa(e,n,a){if(n===0){const r=re(e);return r!==!1&&($(e)&&a.syntaxFlags.add(f.HasDimensionValues),r)}if(Y(e)){n===3?a.syntaxFlags.add(f.HasPercentageAlpha):a.syntaxFlags.add(f.HasPercentageValues);let r=p(e[4].value,1,0,100);return n===3&&(r=p(e[4].value,100,0,1)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}if(S(e)){if(n!==3)return!1;let r=p(e[4].value,1,0,100);return n===3&&(r=p(e[4].value,1,0,1)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}return!1}function Ha(e,n,a){if(P(e)&&C(e[4].value)==="none")return a.syntaxFlags.add(f.HasNoneKeywords),[N.Number,"none",e[2],e[3],{value:Number.NaN,type:b.Number}];if(n===0){const r=re(e);return r!==!1&&($(e)&&a.syntaxFlags.add(f.HasDimensionValues),r)}if(Y(e)){n===3?a.syntaxFlags.add(f.HasPercentageAlpha):a.syntaxFlags.add(f.HasPercentageValues);let r=e[4].value;return n===3?r=p(e[4].value,100,0,1):n===1&&(r=p(e[4].value,1,0,2147483647)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}if(S(e)){n!==3&&a.syntaxFlags.add(f.HasNumberValues);let r=e[4].value;return n===3?r=p(e[4].value,1,0,1):n===1&&(r=p(e[4].value,1,0,2147483647)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}return!1}function Se(e,n,a,r){const h=[],c=[],t=[],o=[],i={colorNotation:a,channels:[0,0,0],alpha:1,syntaxFlags:new Set(r)};let s=h;for(let k=0;k<e.value.length;k++){let x=e.value[k];if(!V(x)&&!K(x)){if(g(x)&&ee(x.value)){if(s===h){s=c;continue}if(s===c){s=t;continue}if(s===t){s=o;continue}if(s===o)return!1}if(E(x)){if(s===o&&x.getName().toLowerCase()==="var"){i.syntaxFlags.add(f.HasVariableAlpha),s.push(x);continue}if(!ae.has(x.getName().toLowerCase()))return!1;const[[_]]=ne([[x]],{censorIntoStandardRepresentableValues:!0,precision:-1,toCanonicalUnits:!0,rawPercentages:!0});if(!_||!g(_)||!Q(_.value))return!1;Number.isNaN(_.value[4].value)&&(_.value[4].value=0),x=_}if(!g(x))return!1;s.push(x)}}if(s.length!==1||h.length!==1||c.length!==1||t.length!==1||!g(h[0])||!g(c[0])||!g(t[0]))return!1;const u=n(h[0].value,0,i);if(!u||!S(u))return!1;const m=n(c[0].value,1,i);if(!m||!S(m))return!1;const y=n(t[0].value,2,i);if(!y||!S(y))return!1;const d=[u,m,y];if(o.length===1)if(i.syntaxFlags.add(f.HasAlpha),g(o[0])){const k=n(o[0].value,3,i);if(!k||!S(k))return!1;d.push(k)}else i.alpha=o[0];return i.channels=[d[0][4].value,d[1][4].value,d[2][4].value],d.length===4&&(i.alpha=d[3][4].value),i}function j(e,n,a,r,h){const c=[],t=[],o=[],i=[];let s,u,m=!1;const y={colorNotation:a,channels:[0,0,0],alpha:1,syntaxFlags:new Set(r)};let d=c;for(let H=0;H<e.value.length;H++){let D=e.value[H];if(V(D)||K(D))for(;V(e.value[H+1])||K(e.value[H+1]);)H++;else if(d===c&&c.length&&(d=t),d===t&&t.length&&(d=o),g(D)&&oe(D.value)&&D.value[4].value==="/"){if(d===i)return!1;d=i}else{if(E(D)){if(d===i&&D.getName().toLowerCase()==="var"){y.syntaxFlags.add(f.HasVariableAlpha),d.push(D);continue}if(!ae.has(D.getName().toLowerCase()))return!1;const[[I]]=ne([[D]],{censorIntoStandardRepresentableValues:!0,globals:u,precision:-1,toCanonicalUnits:!0,rawPercentages:!0});if(!I||!g(I)||!Q(I.value))return!1;Number.isNaN(I.value[4].value)&&(I.value[4].value=0),D=I}if(d===c&&c.length===0&&g(D)&&P(D.value)&&D.value[4].value.toLowerCase()==="from"){if(m)return!1;for(;V(e.value[H+1])||K(e.value[H+1]);)H++;if(H++,D=e.value[H],m=h(D),m===!1)return!1;m.syntaxFlags.has(f.Experimental)&&y.syntaxFlags.add(f.Experimental),y.syntaxFlags.add(f.RelativeColorSyntax),m.colorNotation!==a&&(m=z(m,a)),s=ce(m),u=ie(s)}else{if(!g(D))return!1;if(P(D.value)&&s){const I=D.value[4].value.toLowerCase();if(s.has(I)){d.push(new w(s.get(I)));continue}}d.push(D)}}}if(d.length!==1||c.length!==1||t.length!==1||o.length!==1||!g(c[0])||!g(t[0])||!g(o[0])||s&&!s.has("alpha"))return!1;const k=n(c[0].value,0,y);if(!k||!S(k))return!1;const x=n(t[0].value,1,y);if(!x||!S(x))return!1;const _=n(o[0].value,2,y);if(!_||!S(_))return!1;const v=[k,x,_];if(i.length===1)if(y.syntaxFlags.add(f.HasAlpha),g(i[0])){const H=n(i[0].value,3,y);if(!H||!S(H))return!1;v.push(H)}else y.alpha=i[0];else if(s&&s.has("alpha")){const H=n(s.get("alpha"),3,y);if(!H||!S(H))return!1;v.push(H)}return y.channels=[v[0][4].value,v[1][4].value,v[2][4].value],v.length===4&&(y.alpha=v[3][4].value),y}function wa(e,n){if(e.value.some(a=>g(a)&&ee(a.value))){const a=La(e);if(a!==!1)return a}{const a=Ca(e,n);if(a!==!1)return a}return!1}function La(e){return Se(e,xa,l.HSL,[f.LegacyHSL])}function Ca(e,n){return j(e,Ha,l.HSL,[],n)}function Da(e,n,a){if(P(e)&&C(e[4].value)==="none")return a.syntaxFlags.add(f.HasNoneKeywords),[N.Number,"none",e[2],e[3],{value:Number.NaN,type:b.Number}];if(n===0){const r=re(e);return r!==!1&&($(e)&&a.syntaxFlags.add(f.HasDimensionValues),r)}if(Y(e)){n===3?a.syntaxFlags.add(f.HasPercentageAlpha):a.syntaxFlags.add(f.HasPercentageValues);let r=e[4].value;return n===3&&(r=p(e[4].value,100,0,1)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}if(S(e)){n!==3&&a.syntaxFlags.add(f.HasNumberValues);let r=e[4].value;return n===3&&(r=p(e[4].value,1,0,1)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}return!1}function Sa(e,n,a){if(P(e)&&C(e[4].value)==="none")return a.syntaxFlags.add(f.HasNoneKeywords),[N.Number,"none",e[2],e[3],{value:Number.NaN,type:b.Number}];if(Y(e)){n!==3&&a.syntaxFlags.add(f.HasPercentageValues);let r=p(e[4].value,1,0,100);return n===1||n===2?r=p(e[4].value,.8,-2147483647,2147483647):n===3&&(r=p(e[4].value,100,0,1)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}if(S(e)){n!==3&&a.syntaxFlags.add(f.HasNumberValues);let r=p(e[4].value,1,0,100);return n===1||n===2?r=p(e[4].value,1,-2147483647,2147483647):n===3&&(r=p(e[4].value,1,0,1)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}return!1}function ka(e,n){return j(e,Sa,l.Lab,[],n)}function Fa(e,n,a){if(P(e)&&C(e[4].value)==="none")return a.syntaxFlags.add(f.HasNoneKeywords),[N.Number,"none",e[2],e[3],{value:Number.NaN,type:b.Number}];if(n===2){const r=re(e);return r!==!1&&($(e)&&a.syntaxFlags.add(f.HasDimensionValues),r)}if(Y(e)){n!==3&&a.syntaxFlags.add(f.HasPercentageValues);let r=p(e[4].value,1,0,100);return n===1?r=p(e[4].value,100/150,0,2147483647):n===3&&(r=p(e[4].value,100,0,1)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}if(S(e)){n!==3&&a.syntaxFlags.add(f.HasNumberValues);let r=p(e[4].value,1,0,100);return n===1?r=p(e[4].value,1,0,2147483647):n===3&&(r=p(e[4].value,1,0,1)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}return!1}function Ra(e,n){return j(e,Fa,l.LCH,[],n)}const ke=new Map;for(const[e,n]of Object.entries(Pe))ke.set(e,n);function Pa(e){const n=ke.get(C(e));return!!n&&{colorNotation:l.RGB,channels:[n[0]/255,n[1]/255,n[2]/255],alpha:1,syntaxFlags:new Set([f.ColorKeyword,f.NamedColor])}}function Ba(e,n,a){if(P(e)&&C(e[4].value)==="none")return a.syntaxFlags.add(f.HasNoneKeywords),[N.Number,"none",e[2],e[3],{value:Number.NaN,type:b.Number}];if(Y(e)){n!==3&&a.syntaxFlags.add(f.HasPercentageValues);let r=p(e[4].value,100,0,1);return n===1||n===2?r=p(e[4].value,250,-2147483647,2147483647):n===3&&(r=p(e[4].value,100,0,1)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}if(S(e)){n!==3&&a.syntaxFlags.add(f.HasNumberValues);let r=p(e[4].value,1,0,1);return n===1||n===2?r=p(e[4].value,1,-2147483647,2147483647):n===3&&(r=p(e[4].value,1,0,1)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}return!1}function Xa(e,n){return j(e,Ba,l.OKLab,[],n)}function Za(e,n,a){if(P(e)&&C(e[4].value)==="none")return a.syntaxFlags.add(f.HasNoneKeywords),[N.Number,"none",e[2],e[3],{value:Number.NaN,type:b.Number}];if(n===2){const r=re(e);return r!==!1&&($(e)&&a.syntaxFlags.add(f.HasDimensionValues),r)}if(Y(e)){n!==3&&a.syntaxFlags.add(f.HasPercentageValues);let r=p(e[4].value,100,0,1);return n===1?r=p(e[4].value,250,0,2147483647):n===3&&(r=p(e[4].value,100,0,1)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}if(S(e)){n!==3&&a.syntaxFlags.add(f.HasNumberValues);let r=p(e[4].value,1,0,1);return n===1?r=p(e[4].value,1,0,2147483647):n===3&&(r=p(e[4].value,1,0,1)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}return!1}function Ma(e,n){return j(e,Za,l.OKLCH,[],n)}function Ga(e,n,a){if(Y(e)){n===3?a.syntaxFlags.add(f.HasPercentageAlpha):a.syntaxFlags.add(f.HasPercentageValues);const r=p(e[4].value,100,0,1);return[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}if(S(e)){n!==3&&a.syntaxFlags.add(f.HasNumberValues);let r=p(e[4].value,255,0,1);return n===3&&(r=p(e[4].value,1,0,1)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}return!1}function Ya(e,n,a){if(P(e)&&e[4].value.toLowerCase()==="none")return a.syntaxFlags.add(f.HasNoneKeywords),[N.Number,"none",e[2],e[3],{value:Number.NaN,type:b.Number}];if(Y(e)){n!==3&&a.syntaxFlags.add(f.HasPercentageValues);let r=p(e[4].value,100,-2147483647,2147483647);return n===3&&(r=p(e[4].value,100,0,1)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}if(S(e)){n!==3&&a.syntaxFlags.add(f.HasNumberValues);let r=p(e[4].value,255,-2147483647,2147483647);return n===3&&(r=p(e[4].value,1,0,1)),[N.Number,r.toString(),e[2],e[3],{value:r,type:b.Number}]}return!1}function Va(e,n){if(e.value.some(a=>g(a)&&ee(a.value))){const a=Ka(e);if(a!==!1)return(!a.syntaxFlags.has(f.HasNumberValues)||!a.syntaxFlags.has(f.HasPercentageValues))&&a}else{const a=Oa(e,n);if(a!==!1)return a}return!1}function Ka(e){return Se(e,Ga,l.RGB,[f.LegacyRGB])}function Oa(e,n){return j(e,Ya,l.RGB,[],n)}function fe(e){const n=le(e);if(me(n))return ve(n);let a=e;return a=te(a),a[0]<1e-6&&(a=[0,0,0]),a[0]>.999999&&(a=[1,0,0]),ra(ge(a,za,Aa))}function za(e){return e=de(e),e=ye(e),sa(e)}function Aa(e){return e=oa(e),e=He(e),xe(e)}function Ia(e,n){let a=!1;for(let t=0;t<e.value.length;t++){const o=e.value[t];if(!V(o)&&!K(o)&&(a||(a=n(o),!a)))return!1}if(!a)return!1;a.channels=X(a.channels),a.channels=fe(T(a).channels),a.colorNotation=l.sRGB;const r={colorNotation:l.sRGB,channels:[0,0,0],alpha:1,syntaxFlags:new Set([f.ContrastColor,f.Experimental])},h=_e(a.channels,[1,1,1]),c=_e(a.channels,[0,0,0]);return r.channels=h>c?[1,1,1]:[0,0,0],r}function Wa(e,n){let a,r,h=!1,c=!1,t=!1;const o={colorNotation:l.sRGB,channels:[0,0,0],alpha:1,syntaxFlags:new Set([])};for(let i=0;i<e.value.length;i++){let s=e.value[i];if(V(s)||K(s))for(;V(e.value[i+1])||K(e.value[i+1]);)i++;else if(t&&!h&&!c&&g(s)&&oe(s.value)&&s.value[4].value==="/")h=!0;else{if(E(s)&&ae.has(C(s.getName()))){const[[u]]=ne([[s]],{censorIntoStandardRepresentableValues:!0,globals:r,precision:-1,toCanonicalUnits:!0,rawPercentages:!0});if(!u||!g(u)||!Q(u.value))return!1;Number.isNaN(u.value[4].value)&&(u.value[4].value=0),s=u}if(h||c||!g(s)||!P(s.value)||C(s.value[4].value)!=="from"){if(!h||c)return!1;if(g(s)){if(P(s.value)&&C(s.value[4].value)==="alpha"&&a&&a.has("alpha")){o.alpha=a.get("alpha")[4].value,c=!0;continue}const u=J(s.value,3,o);if(!u||!S(u))return!1;o.alpha=new w(u),c=!0;continue}if(E(s)){const u=ua([[s]],m=>{if(g(m)&&P(m.value)&&C(m.value[4].value)==="alpha"&&a&&a.has("alpha"))return new w(a.get("alpha"))});o.alpha=u[0][0],c=!0;continue}return!1}if(t)return!1;for(;V(e.value[i+1])||K(e.value[i+1]);)i++;if(i++,s=e.value[i],t=n(s),t===!1)return!1;a=ce(t),r=ie(a),o.syntaxFlags=new Set(t.syntaxFlags),o.syntaxFlags.add(f.RelativeAlphaSyntax),o.channels=[...t.channels],o.colorNotation=t.colorNotation,o.alpha=t.alpha}}return!!a&&o}function Ta(e){const n=ue(e);if(me(n))return ve(n);let a=e;return a=te(a),a[0]<1e-6&&(a=[0,0,0]),a[0]>.999999&&(a=[1,0,0]),Ae(ge(a,Ea,Ua))}function Ea(e){return e=de(e),e=ye(e),la(e)}function Ua(e){return e=ta(e),e=He(e),xe(e)}function F(e,n=7){e=+e,n=+n;const a=(Math.floor(Math.abs(e))+"").length;if(n>a)return+e.toFixed(n-a);{const r=10**(a-n);return Math.round(e/r)*r}}function Fe(e,n,a,r){const h=[N.CloseParen,")",-1,-1,void 0];if(typeof e.alpha=="number"){const c=Math.min(1,Math.max(0,F(Number.isNaN(e.alpha)?0:e.alpha)));return F(c,4)===1?new W(n,h,r):new W(n,h,[...r,new B([a]),new w([N.Delim,"/",-1,-1,{value:"/"}]),new B([a]),new w([N.Number,F(c,4).toString(),-1,-1,{value:e.alpha,type:b.Integer}])])}return new W(n,h,[...r,new B([a]),new w([N.Delim,"/",-1,-1,{value:"/"}]),new B([a]),e.alpha])}function ja(e,n=!0){e.channels=q(e.channels,e.colorNotation);let a=e.channels.map(i=>Number.isNaN(i)?0:i);n?a=Ta(T(e).channels):e.colorNotation!==l.Display_P3&&(a=ue(T(e).channels));const r=n?Math.min(1,Math.max(0,F(a[0],6))):F(a[0],6),h=n?Math.min(1,Math.max(0,F(a[1],6))):F(a[1],6),c=n?Math.min(1,Math.max(0,F(a[2],6))):F(a[2],6),t=[N.Function,"color(",-1,-1,{value:"color"}],o=[N.Whitespace," ",-1,-1,void 0];return Fe(e,t,o,[new w([N.Ident,"display-p3",-1,-1,{value:"display-p3"}]),new B([o]),new w([N.Number,r.toString(),-1,-1,{value:a[0],type:b.Number}]),new B([o]),new w([N.Number,h.toString(),-1,-1,{value:a[1],type:b.Number}]),new B([o]),new w([N.Number,c.toString(),-1,-1,{value:a[2],type:b.Number}])])}function $a(e,n=!0){e.channels=q(e.channels,e.colorNotation);let a=e.channels.map(u=>Number.isNaN(u)?0:u);a=n?fe(T(e).channels):le(T(e).channels);const r=Math.min(255,Math.max(0,Math.round(255*F(a[0])))),h=Math.min(255,Math.max(0,Math.round(255*F(a[1])))),c=Math.min(255,Math.max(0,Math.round(255*F(a[2])))),t=[N.CloseParen,")",-1,-1,void 0],o=[N.Whitespace," ",-1,-1,void 0],i=[N.Comma,",",-1,-1,void 0],s=[new w([N.Number,r.toString(),-1,-1,{value:Math.min(255,255*Math.max(0,a[0])),type:b.Integer}]),new w(i),new B([o]),new w([N.Number,h.toString(),-1,-1,{value:Math.min(255,255*Math.max(0,a[1])),type:b.Integer}]),new w(i),new B([o]),new w([N.Number,c.toString(),-1,-1,{value:Math.min(255,255*Math.max(0,a[2])),type:b.Integer}])];if(typeof e.alpha=="number"){const u=Math.min(1,Math.max(0,F(Number.isNaN(e.alpha)?0:e.alpha)));return F(u,4)===1?new W([N.Function,"rgb(",-1,-1,{value:"rgb"}],t,s):new W([N.Function,"rgba(",-1,-1,{value:"rgba"}],t,[...s,new w(i),new B([o]),new w([N.Number,F(u,4).toString(),-1,-1,{value:e.alpha,type:b.Number}])])}return new W([N.Function,"rgba(",-1,-1,{value:"rgba"}],t,[...s,new w(i),new B([o]),e.alpha])}function qa(e,n=!0){e.channels=q(e.channels,e.colorNotation);let a=e.channels.map(u=>Number.isNaN(u)?0:u);a=Ne(n?pe(fe(T(e).channels)):T(e).channels),a=a.map(u=>Number.isNaN(u)?0:u);const r=Math.min(360,Math.max(0,Math.round(F(a[0])))),h=Math.min(100,Math.max(0,Math.round(F(a[1])))),c=Math.min(100,Math.max(0,Math.round(F(a[2])))),t=[N.CloseParen,")",-1,-1,void 0],o=[N.Whitespace," ",-1,-1,void 0],i=[N.Comma,",",-1,-1,void 0],s=[new w([N.Number,r.toString(),-1,-1,{value:a[0],type:b.Integer}]),new w(i),new B([o]),new w([N.Percentage,h.toString()+"%",-1,-1,{value:a[1]}]),new w(i),new B([o]),new w([N.Percentage,c.toString()+"%",-1,-1,{value:a[2]}])];if(typeof e.alpha=="number"){const u=Math.min(1,Math.max(0,F(Number.isNaN(e.alpha)?0:e.alpha)));return F(u,4)===1?new W([N.Function,"hsl(",-1,-1,{value:"hsl"}],t,s):new W([N.Function,"hsla(",-1,-1,{value:"hsla"}],t,[...s,new w(i),new B([o]),new w([N.Number,F(u,4).toString(),-1,-1,{value:e.alpha,type:b.Number}])])}return new W([N.Function,"hsla(",-1,-1,{value:"hsla"}],t,[...s,new w(i),new B([o]),e.alpha])}function Ja(e){e.channels=q(e.channels,e.colorNotation);let n=e.channels.map(o=>Number.isNaN(o)?0:o);e.colorNotation!==l.OKLCH&&(n=te(T(e).channels));const a=F(n[0],6),r=F(n[1],6),h=F(n[2],6),c=[N.Function,"oklch(",-1,-1,{value:"oklch"}],t=[N.Whitespace," ",-1,-1,void 0];return Fe(e,c,t,[new w([N.Number,a.toString(),-1,-1,{value:n[0],type:b.Number}]),new B([t]),new w([N.Number,r.toString(),-1,-1,{value:n[1],type:b.Number}]),new B([t]),new w([N.Number,h.toString(),-1,-1,{value:n[2],type:b.Number}])])}function G(e){if(E(e))switch(C(e.getName())){case"rgb":case"rgba":return Va(e,G);case"hsl":case"hsla":return wa(e,G);case"hwb":return n=G,j(e,Da,l.HWB,[],n);case"lab":return ka(e,G);case"lch":return Ra(e,G);case"oklab":return Xa(e,G);case"oklch":return Ma(e,G);case"color":return pa(e,G);case"color-mix":return ga(e,G);case"contrast-color":return Ia(e,G);case"alpha":return Wa(e,G)}var n;if(g(e)){if(Re(e.value))return ya(e.value);if(P(e.value)){const a=Pa(e.value[4].value);return a!==!1?a:C(e.value[4].value)==="transparent"&&{colorNotation:l.RGB,channels:[0,0,0],alpha:0,syntaxFlags:new Set([f.ColorKeyword])}}}return!1}export{l as ColorNotation,f as SyntaxFlag,G as color,ha as colorDataFitsDisplayP3_Gamut,ia as colorDataFitsRGB_Gamut,qa as serializeHSL,Ja as serializeOKLCH,ja as serializeP3,$a as serializeRGB};
