const m=/^[A-Za-z]:\//;function f(t=""){return t&&t.replace(/\\/g,"/").replace(m,n=>n.toUpperCase())}const S=/^[/\\]{2}/,b=/^[/\\](?![/\\])|^[/\\]{2}(?!\.)|^[A-Za-z]:[/\\]/,d=/^[A-Za-z]:$/,A=function(t){if(t.length===0)return".";t=f(t);const n=t.match(S),e=h(t),s=t[t.length-1]==="/";return t=E(t,!e),t.length===0?e?"/":s?"./":".":(s&&(t+="/"),d.test(t)&&(t+="/"),n?e?`//${t}`:`//./${t}`:e&&!h(t)?`/${t}`:t)},g=function(...t){let n="";for(const e of t)if(e)if(n.length>0){const s=n[n.length-1]==="/",l=e[0]==="/";s&&l?n+=e.slice(1):n+=s||l?e:`/${e}`}else n+=e;return A(n)};function E(t,n){let e="",s=0,l=-1,i=0,o=null;for(let r=0;r<=t.length;++r){if(r<t.length)o=t[r];else{if(o==="/")break;o="/"}if(o==="/"){if(!(l===r-1||i===1))if(i===2){if(e.length<2||s!==2||e[e.length-1]!=="."||e[e.length-2]!=="."){if(e.length>2){const a=e.lastIndexOf("/");a===-1?(e="",s=0):(e=e.slice(0,a),s=e.length-1-e.lastIndexOf("/")),l=r,i=0;continue}else if(e.length>0){e="",s=0,l=r,i=0;continue}}n&&(e+=e.length>0?"/..":"..",s=2)}else e.length>0?e+=`/${t.slice(l+1,r)}`:e=t.slice(l+1,r),s=r-l-1;l=r,i=0}else o==="."&&i!==-1?++i:i=-1}return e}const h=function(t){return b.test(t)},R=new Set(["/","\\",void 0]),_=Symbol.for("pathe:normalizedAlias"),z=/[/\\]/;function u(t){if(t[_])return t;const n=Object.fromEntries(Object.entries(t).sort(([e],[s])=>x(e,s)));for(const e in n)for(const s in n)s===e||e.startsWith(s)||n[e]?.startsWith(s)&&R.has(n[e][s.length])&&(n[e]=n[s]+n[e].slice(s.length));return Object.defineProperty(n,_,{value:!0,enumerable:!1}),n}function O(t,n){const e=f(t);n=u(n);for(const[s,l]of Object.entries(n)){if(!e.startsWith(s))continue;const i=c(s)?s.slice(0,-1):s;if(c(e[i.length]))return g(l,e.slice(s.length))}return e}function T(t,n){const e=f(t);n=u(n);const s=[];for(const[l,i]of Object.entries(n)){if(!e.startsWith(i))continue;const o=c(i)?i.slice(0,-1):i;c(e[o.length])&&s.push(g(l,e.slice(i.length)))}return s.sort((l,i)=>i.length-l.length)}function I(t){const n=t.split(z).pop();if(!n)return;const e=n.lastIndexOf(".");return e<=0?n:n.slice(0,e)}function x(t,n){return n.split("/").length-t.split("/").length}function c(t="/"){const n=t[t.length-1];return n==="/"||n==="\\"}export{I as filename,u as normalizeAliases,O as resolveAlias,T as reverseResolveAlias};
